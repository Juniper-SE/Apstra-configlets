{
  "id": "7aba98a6-24f2-43a3-b445-137c4e1d5486",
  "ref_archs": [
    "two_stage_l3clos"
  ],
  "created_at": "2024-06-21T16:17:59.912624Z",
  "last_modified_at": "2024-06-27T22:29:57.251936Z",
  "display_name": "_Full_GBP_Configlet",
  "generators": [
    {
      "config_style": "junos",
      "template_text": "set chassis forwarding-options vxlan-gbp-profile\nset forwarding-options evpn-vxlan gbp ingress-enforcement\n\n{% set data = namespace(src_tag_list=[]) %}\n\nfirewall {\n    family any {\n       filter MSEG {\n{% for all_filters in gbp_info %}\n    {% for src_tag, src_tag_filters in all_filters.iteritems() %}\n        {% if src_tag not in data.src_tag_list %}\n            {% set data.src_tag_list = data.src_tag_list + [src_tag] %}\n        {% endif %}\n        {% for dst_tag_info in src_tag_filters %}\n            {% for dst_tag, action in dst_tag_info.items() %}\n        term From{{src_tag}}-To{{dst_tag}} {\n            from {\n                gbp-src-tag {{src_tag}};\n                gbp-dst-tag {{dst_tag}};\n            }\n            then {\n                count GBP{{src_tag}}-{{dst_tag}};\n                {{action}};\n                }\n            }\n            {% endfor %}\n        {% endfor %}\n    {% endfor %}\n{% endfor %}\n        }\n    }\n}\n\n{% set unique_src_tag_list= data.src_tag_list %}\n\n\n{% for src_tag in unique_src_tag_list %}\n    {% for if_name,if_param in interface.items() %}\n        {% for tags in if_param['intf_tags'] %}\n            {% if tags == \"gbp_\"+src_tag %}\n                {% if if_param['part_of'] %}\nset firewall family any filter GBP-TAG term TAG{{src_tag}}-{{if_param['part_of']}} from interface {{if_param['part_of']}}.0\nset firewall family any filter GBP-TAG term TAG{{src_tag}}-{{if_param['part_of']}} then gbp-tag {{src_tag}}\n                {% else %} \n                    {% if \"ae\" not in if_param['intfName'] %}\nset firewall family any filter GBP-TAG term TAG{{src_tag}}-{{if_param['intfName']}} from interface {{if_param['intfName']}}.0\nset firewall family any filter GBP-TAG term TAG{{src_tag}}-{{if_param['intfName']}} then gbp-tag {{src_tag}}\n                    {% endif %}\n                {% endif %}\n            {% endif %}\n        {% endfor %}\n    {% endfor %}\n{% endfor %}\n",
      "section": "system",
      "negation_template_text": "",
      "filename": ""
    }
  ]
}
